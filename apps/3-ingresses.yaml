---
apiVersion: traefik.containo.us/v1alpha1
kind: IngressRoute
metadata:
  name: path-ingress
  namespace: playground
  annotations:
    kubernetes.io/ingress.class: traefik-ninja
  labels:
    tier: frontend
spec:
  entryPoints:
    - http
  routes:
    - match: PathPrefix(`/whoami`)
      kind: Rule
      services:
        - name: whoami
          port: 80
      middlewares:
        - name: add-foo
---
# apiVersion: traefik.containo.us/v1alpha1
# kind: IngressRouteTCP
# metadata:
#   name: match-all-tcp
#   namespace: playground
#   annotations:
#     kubernetes.io/ingress.class: traefik-ninja
#   labels:
#     tier: frontend
# spec:
#   entryPoints:
#     - tcp
#   routes:
#     - match: HostSNI(`*`)
#       services:
#         - name: whoamitcp
#           port: 8080
# ---
# apiVersion: traefik.containo.us/v1alpha1
# kind: IngressRouteTCP
# metadata:
#   name: match-all-tcp-tls
#   namespace: playground
#   annotations:
#     kubernetes.io/ingress.class: traefik-ninja
#   labels:
#     tier: frontend
# spec:
#   entryPoints:
#     - tcp
#   routes:
#     - match: HostSNI(`whoamitcp.docker.localhost`)
#     # - match: HostSNI(`*`)
#       services:
#         - name: whoamitcp
#           port: 8080
#   tls:
#     secretName: tls.docker.localhost
---
apiVersion: traefik.containo.us/v1alpha1
kind: IngressRouteTCP
metadata:
  name: match-all-tcp-tls-passthrough
  namespace: playground
  annotations:
    kubernetes.io/ingress.class: traefik-ninja
  labels:
    tier: frontend
spec:
  entryPoints:
    - tcp
  routes:
    - match: HostSNI(`tls.docker.localhost`)
      services:
        - name: whoamitcptls
          port: 8080
  tls:
    passthrough: true
